namespace Infrastructure.Tests.Vulnerability
{
    using FluentAssertions;

    using NUnit.Framework;

    using Common.Enums;
    using Infrastructure.Vulnerability;

    [TestFixture]
    public sealed class XmlVulnerabilitySeverityResolverTest
    {
        private IVulnerabilitySeverityResolver _target;

        [SetUp]
        public void SetUp() => _target = new XmlVulnerabilitySeverityResolver();

        [Test]
        public void ShouldReturnUnknownVulnerabilityType()
        {
            var result = _target.Resolve("Halo");

            result.ShouldBeEquivalentTo(VulnerabilitySeverityType.Unknown);
        }

        [TestCase("SQL Injection", ExpectedResult = VulnerabilitySeverityType.High)]
        [TestCase("Log Forging", ExpectedResult = VulnerabilitySeverityType.Medium)]
        public VulnerabilitySeverityType ShouldReturnEqualsVulnerabilityType(string vulnerabilityName) =>
                _target.Resolve(vulnerabilityName);
    }
}